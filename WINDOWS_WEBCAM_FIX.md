# Windows에서 웹캠 연결 문제 해결하기

## 🚨 문제 진단

Windows에서 웹캠이 연결되지 않는 경우 다음 단계를 따라 문제를 진단하고 해결하세요.

## 🔍 1단계: 웹캠 진단 실행

먼저 웹캠 상태를 진단해보세요:

```cmd
python webcam_test.py
```

이 스크립트는 다음을 확인합니다:

- 사용 가능한 카메라 목록
- 각 백엔드별 연결 상태
- 실제 카메라 설정값

## 🛠️ 2단계: 일반적인 해결 방법

### **웹캠 권한 확인**

1. Windows 설정 → 개인정보 → 카메라
2. "앱이 카메라에 액세스할 수 있도록 허용" 활성화
3. "데스크톱 앱이 카메라에 액세스할 수 있도록 허용" 활성화

### **다른 프로그램에서 웹캠 사용 중인지 확인**

- Zoom, Teams, Discord 등이 실행 중인지 확인
- Windows 카메라 앱이 실행 중인지 확인
- 작업 관리자에서 카메라 관련 프로세스 종료

### **웹캠 드라이버 업데이트**

1. 장치 관리자 → 이미징 장치
2. 웹캠 우클릭 → 드라이버 업데이트
3. 또는 제조사 웹사이트에서 최신 드라이버 다운로드

## 🔧 3단계: 고급 해결 방법

### **DirectShow 필터 확인**

1. DirectShow Filter Manager 설치 (선택사항)
2. 웹캠 필터가 제대로 등록되어 있는지 확인

### **레지스트리 수정 (주의 필요)**

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Media Foundation\Platform
```

- EnableFrameServerMode = 0 설정

### **관리자 권한으로 실행**

- 명령 프롬프트를 관리자 권한으로 실행
- Python과 게임을 관리자 권한으로 실행

## 📱 4단계: 하드웨어 확인

### **물리적 연결**

1. USB 포트 변경
2. 다른 USB 케이블 사용
3. 웹캠 LED가 켜지는지 확인

### **웹캠 테스트**

1. Windows 카메라 앱에서 웹캠 작동 확인
2. 다른 컴퓨터에서 웹캠 테스트

## 🎯 5단계: 코드 수정

### **카메라 인덱스 변경**

`ui/game_state.py`에서 카메라 인덱스를 수정:

```python
# 기본값을 1로 변경 (Windows에서 0번이 안 될 수 있음)
state = GameState(cam_index=1, target_fps=30, prefer_size=(1280, 720), player_name=player_name)
```

### **백엔드 우선순위 변경**

Windows에서는 DirectShow를 우선 사용:

```python
# Windows에서 권장 백엔드 순서
if os.name == 'nt':
    backends = [cv.CAP_DSHOW, cv.CAP_MSMF, cv.CAP_ANY]
```

## 🚀 6단계: 대안 해결책

### **가상 웹캠 사용**

1. OBS Studio 설치
2. 가상 웹캠 생성
3. 게임에서 가상 웹캠 사용

### **웹캠 없이 게임 실행**

웹캠이 연결되지 않아도 게임은 실행됩니다:

- 웹캠 영역에 "웹캠 연결 안됨" 메시지 표시
- 게임 기능은 정상 작동

## 📋 문제 해결 체크리스트

- [ ] `webcam_test.py` 실행하여 진단
- [ ] 웹캠 권한 확인
- [ ] 다른 프로그램에서 웹캠 사용 중인지 확인
- [ ] 드라이버 업데이트
- [ ] USB 포트/케이블 변경
- [ ] Windows 카메라 앱에서 테스트
- [ ] 관리자 권한으로 실행
- [ ] 카메라 인덱스 변경 (0→1)

## 🆘 추가 도움

문제가 지속되면 다음 정보를 수집하여 도움을 요청하세요:

1. `webcam_test.py` 실행 결과
2. Windows 버전
3. 웹캠 모델명
4. 오류 메시지 전체 내용
5. 장치 관리자 스크린샷

## 💡 예방 방법

- 게임 실행 전 다른 프로그램에서 웹캠 사용 중지
- 정기적인 드라이버 업데이트
- USB 포트 정리 및 관리
- Windows 업데이트 유지

